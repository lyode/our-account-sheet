import React, { useState } from 'react';
import { Plus, Minus, DollarSign, Calendar, Tag, Trash2, Home, TrendingUp, List, Target, ArrowUp, ArrowDown, PieChart, Wallet, CreditCard } from 'lucide-react';

export default function MyFinancialPlanningApp() {
  const [transactions, setTransactions] = useState([]);
  const [activeTab, setActiveTab] = useState('home');
  const [showAddForm, setShowAddForm] = useState(false);
  const [description, setDescription] = useState('');
  const [amount, setAmount] = useState('');
  const [category, setCategory] = useState('');
  const [type, setType] = useState('expense');
  const [paymentMethod, setPaymentMethod] = useState('');
  const [isPaymentMode, setIsPaymentMode] = useState(false);

  const categories = [
    'Food & Dining', 'Transportation', 'Shopping', 'Entertainment',
    'Bills & Utilities', 'Healthcare', 'Education', 'Travel',
    'Salary', 'Business', 'Investment', 'Gift', 'Savings', 'Other'
  ];

  const paymentMethods = [
    'Cash', 'Credit Card', 'Debit Card', 'Bank Transfer', 
    'Digital Wallet', 'Check', 'Mobile Payment', 'Online Banking', 'Other'
  ];

  const paymentCategories = [
    'Bills & Utilities', 'Healthcare', 'Education', 'Transportation',
    'Food & Dining', 'Shopping', 'Other'
  ];

  const addTransaction = () => {
    if (!description.trim()) {
      alert('Please enter a description');
      return;
    }
    if (!amount || parseFloat(amount) <= 0) {
      alert('Please enter a valid amount');
      return;
    }
    if (!category) {
      alert('Please select a category');
      return;
    }
    if (!paymentMethod) {
      alert('Please select a payment method');
      return;
    }

    const newTransaction = {
      id: Date.now(),
      description: description.trim(),
      amount: parseFloat(amount),
      category,
      type,
      paymentMethod,
      isPayment: isPaymentMode,
      date: new Date().toLocaleDateString(),
      time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
    };

    setTransactions([newTransaction, ...transactions]);
    setDescription('');
    setAmount('');
    setCategory('');
    setPaymentMethod('');
    setIsPaymentMode(false);
    setShowAddForm(false);
  };

  const deleteTransaction = (id) => {
    setTransactions(transactions.filter(t => t.id !== id));
  };

  const totalIncome = transactions
    .filter(t => t.type === 'income')
    .reduce((sum, t) => sum + t.amount, 0);

  const totalExpenses = transactions
    .filter(t => t.type === 'expense')
    .reduce((sum, t) => sum + t.amount, 0);

  const balance = totalIncome - totalExpenses;
  const recentTransactions = transactions.slice(0, 5);
  const recentPayments = transactions.filter(t => t.isPayment).slice(0, 3);

  // Calculate category breakdown
  const categoryBreakdown = categories.map(cat => {
    const categoryTransactions = transactions.filter(t => t.category === cat);
    const totalAmount = categoryTransactions.reduce((sum, t) => sum + t.amount, 0);
    return {
      category: cat,
      amount: totalAmount,
      count: categoryTransactions.length,
      percentage: totalExpenses > 0 ? (totalAmount / totalExpenses) * 100 : 0
    };
  }).filter(item => item.amount > 0).sort((a, b) => b.amount - a.amount);

  // Calculate payment method breakdown
  const paymentBreakdown = paymentMethods.map(method => {
    const methodTransactions = transactions.filter(t => t.paymentMethod === method);
    const totalAmount = methodTransactions.reduce((sum, t) => sum + t.amount, 0);
    const totalTransactions = transactions.reduce((sum, t) => sum + t.amount, 0);
    return {
      method: method,
      amount: totalAmount,
      count: methodTransactions.length,
      percentage: totalTransactions > 0 ? (totalAmount / totalTransactions) * 100 : 0
    };
  }).filter(item => item.amount > 0).sort((a, b) => b.amount - a.amount);

  // Home Tab Component
  const HomeTab = () => (
    <div className="p-4 pb-24">
      {/* App Header */}
      <div className="flex items-center justify-between mb-6">
        <div>
          <h1 className="text-2xl font-bold text-gray-800">My Financial Planning</h1>
          <p className="text-gray-500 text-sm">Smart Money Management</p>
        </div>
        <div className="bg-gradient-to-r from-purple-100 to-blue-100 p-3 rounded-full">
          <Wallet className="w-6 h-6 text-purple-600" />
        </div>
      </div>

      {/* Balance Card */}
      <div className="bg-gradient-to-br from-purple-600 to-blue-700 rounded-2xl p-6 text-white mb-6 shadow-lg">
        <div className="flex justify-between items-start mb-4">
          <div>
            <p className="text-purple-100 text-sm">Current Balance</p>
            <h1 className="text-3xl font-bold">${balance.toFixed(2)}</h1>
            <p className="text-purple-200 text-xs mt-1">
              {balance >= 0 ? 'You\'re doing great!' : 'Review your spending'}
            </p>
          </div>
          <DollarSign className="w-8 h-8 text-purple-200" />
        </div>
        
        <div className="grid grid-cols-2 gap-4 mt-6">
          <div className="bg-white bg-opacity-20 rounded-xl p-3">
            <div className="flex items-center mb-1">
              <ArrowUp className="w-4 h-4 text-green-300 mr-1" />
              <span className="text-xs text-purple-100">Income</span>
            </div>
            <p className="text-lg font-semibold">${totalIncome.toFixed(2)}</p>
          </div>
          <div className="bg-white bg-opacity-20 rounded-xl p-3">
            <div className="flex items-center mb-1">
              <ArrowDown className="w-4 h-4 text-red-300 mr-1" />
              <span className="text-xs text-purple-100">Expenses</span>
            </div>
            <p className="text-lg font-semibold">${totalExpenses.toFixed(2)}</p>
          </div>
        </div>
      </div>

      {/* Financial Health */}
      <div className="bg-white rounded-2xl p-4 shadow-sm mb-6">
        <div className="flex items-center justify-between mb-4">
          <h2 className="text-lg font-semibold text-gray-800">Financial Health</h2>
          <Target className="w-5 h-5 text-blue-600" />
        </div>
        <div className="space-y-3">
          <div className="flex justify-between items-center">
            <span className="text-sm text-gray-600">Expense Ratio</span>
            <span className={`text-sm font-medium ${totalIncome > 0 && (totalExpenses/totalIncome) < 0.8 ? 'text-green-600' : 'text-orange-600'}`}>
              {totalIncome > 0 ? `${((totalExpenses/totalIncome) * 100).toFixed(1)}%` : 'N/A'}
            </span>
          </div>
          <div className="w-full bg-gray-200 rounded-full h-2">
            <div 
              className={`h-2 rounded-full ${totalIncome > 0 && (totalExpenses/totalIncome) < 0.8 ? 'bg-green-500' : 'bg-orange-500'}`}
              style={{width: `${totalIncome > 0 ? Math.min((totalExpenses/totalIncome) * 100, 100) : 0}%`}}
            ></div>
          </div>
          <p className="text-xs text-gray-500">Recommended: Keep expenses below 80% of income</p>
          
          {transactions.length > 0 && (
            <div className="pt-2 border-t border-gray-100">
              <div className="flex justify-between items-center">
                <span className="text-sm text-gray-600">Most Used Payment</span>
                <div className="flex items-center text-sm font-medium text-gray-700">
                  <CreditCard className="w-3 h-3 mr-1" />
                  <span>
                    {paymentBreakdown.length > 0 ? paymentBreakdown[0].method : 'N/A'}
                  </span>
                </div>
              </div>
            </div>
          )}
        </div>
      </div>

      {/* Quick Actions */}
      <div className="grid grid-cols-3 gap-3 mb-6">
        <button 
          onClick={() => {setType('income'); setIsPaymentMode(false); setShowAddForm(true);}}
          className="bg-green-500 text-white p-4 rounded-xl flex flex-col items-center justify-center space-y-1 shadow-md active:scale-95 transition-transform"
        >
          <Plus className="w-5 h-5" />
          <span className="font-medium text-xs">Add Income</span>
        </button>
        <button 
          onClick={() => {setType('expense'); setIsPaymentMode(false); setShowAddForm(true);}}
          className="bg-red-500 text-white p-4 rounded-xl flex flex-col items-center justify-center space-y-1 shadow-md active:scale-95 transition-transform"
        >
          <Minus className="w-5 h-5" />
          <span className="font-medium text-xs">Add Expense</span>
        </button>
        <button 
          onClick={() => {
            setType('expense'); 
            setCategory('Bills & Utilities'); 
            setPaymentMethod('Bank Transfer');
            setIsPaymentMode(true);
            setShowAddForm(true);
          }}
          className="bg-blue-500 text-white p-4 rounded-xl flex flex-col items-center justify-center space-y-1 shadow-md active:scale-95 transition-transform"
        >
          <CreditCard className="w-5 h-5" />
          <span className="font-medium text-xs">Record Payment</span>
        </button>
      </div>

      {/* Recent Transactions */}
      <div className="bg-white rounded-2xl p-4 shadow-sm">
        <div className="flex justify-between items-center mb-4">
          <h2 className="text-lg font-semibold text-gray-800">Recent Activity</h2>
          <button 
            onClick={() => setActiveTab('transactions')}
            className="text-purple-600 text-sm font-medium"
          >
            View All
          </button>
        </div>
        
        {recentTransactions.length === 0 ? (
          <div className="text-center py-8 text-gray-400">
            <div className="bg-purple-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
              <DollarSign className="w-8 h-8 text-purple-400" />
            </div>
            <h3 className="font-medium text-gray-800 mb-1">Welcome to Financial Planning!</h3>
            <p className="text-sm mb-4">Start your journey to financial freedom</p>
            <button 
              onClick={() => setShowAddForm(true)}
              className="bg-purple-600 text-white px-4 py-2 rounded-lg text-sm font-medium active:scale-95 transition-transform"
            >
              Add First Transaction
            </button>
          </div>
        ) : (
          <div className="space-y-3">
            {recentTransactions.map(transaction => (
              <div key={transaction.id} className="flex items-center justify-between py-2">
                <div className="flex items-center space-x-3">
                  <div className={`p-2 rounded-full ${transaction.type === 'income' ? 'bg-green-100' : 'bg-red-100'}`}>
                    {transaction.type === 'income' ? 
                      <ArrowUp className="w-4 h-4 text-green-600" /> : 
                      <ArrowDown className="w-4 h-4 text-red-600" />
                    }
                  </div>
                  <div>
                    <p className="font-medium text-gray-800 text-sm">{transaction.description}</p>
                    <div className="flex items-center space-x-2 text-xs text-gray-500">
                      <span>{transaction.category}</span>
                      <span>•</span>
                      <div className="flex items-center">
                        <CreditCard className="w-3 h-3 mr-1" />
                        <span>{transaction.paymentMethod}</span>
                      </div>
                    </div>
                  </div>
                </div>
                <div className="text-right">
                  <p className={`font-semibold ${transaction.type === 'income' ? 'text-green-600' : 'text-red-600'}`}>
                    {transaction.type === 'income' ? '+' : '-'}${transaction.amount.toFixed(2)}
                  </p>
                  <p className="text-xs text-gray-400">{transaction.time}</p>
                </div>
              </div>
            ))}
          </div>
        )}
      </div>

      {/* Recent Payments */}
      {recentPayments.length > 0 && (
        <div className="bg-white rounded-2xl p-4 shadow-sm mt-6">
          <div className="flex items-center justify-between mb-4">
            <h2 className="text-lg font-semibold text-gray-800">Recent Payments</h2>
            <div className="bg-blue-100 p-2 rounded-full">
              <CreditCard className="w-4 h-4 text-blue-600" />
            </div>
          </div>
          
          <div className="space-y-3">
            {recentPayments.map(payment => (
              <div key={payment.id} className="flex items-center justify-between py-2 border-l-4 border-blue-500 pl-3 bg-blue-50 rounded-r-lg">
                <div className="flex items-center space-x-3">
                  <div className="p-2 rounded-full bg-blue-100">
                    <CreditCard className="w-4 h-4 text-blue-600" />
                  </div>
                  <div>
                    <p className="font-medium text-gray-800 text-sm">{payment.description}</p>
                    <div className="flex items-center space-x-2 text-xs text-gray-500">
                      <span>{payment.category}</span>
                      <span>•</span>
                      <span>{payment.paymentMethod}</span>
                    </div>
                  </div>
                </div>
                <div className="text-right">
                  <p className="font-semibold text-blue-600">-${payment.amount.toFixed(2)}</p>
                  <p className="text-xs text-gray-400">{payment.time}</p>
                </div>
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );

  // Transactions Tab Component
  const TransactionsTab = () => (
    <div className="p-4 pb-24">
      <div className="flex items-center justify-between mb-4">
        <div>
          <h1 className="text-xl font-bold text-gray-800">Transaction History</h1>
          <p className="text-gray-500 text-sm">My Financial Planning</p>
        </div>
        <div className="bg-blue-100 p-3 rounded-full">
          <List className="w-5 h-5 text-blue-600" />
        </div>
      </div>

      <div className="bg-white rounded-2xl shadow-sm">
        <div className="p-4 border-b border-gray-100">
          <h2 className="text-lg font-semibold text-gray-800">All Transactions</h2>
          <p className="text-sm text-gray-500">{transactions.length} total entries</p>
        </div>
        
        {transactions.length === 0 ? (
          <div className="text-center py-12 text-gray-400">
            <List className="w-16 h-16 mx-auto mb-4 opacity-30" />
            <p className="text-lg mb-2">No transactions yet</p>
            <p className="text-sm">Begin your financial tracking journey</p>
          </div>
        ) : (
          <div className="divide-y divide-gray-100">
            {transactions.map(transaction => (
              <div key={transaction.id} className="p-4">
                <div className="flex items-center justify-between">
                  <div className="flex items-center space-x-3 flex-1">
                    <div className={`p-2 rounded-full ${transaction.type === 'income' ? 'bg-green-100' : 'bg-red-100'}`}>
                      {transaction.type === 'income' ? 
                        <ArrowUp className="w-4 h-4 text-green-600" /> : 
                        <ArrowDown className="w-4 h-4 text-red-600" />
                      }
                    </div>
                    <div className="flex-1">
                      <p className="font-medium text-gray-800">{transaction.description}</p>
                      <div className="flex items-center text-xs text-gray-500 mt-1 space-x-3">
                        <div className="flex items-center">
                          <Tag className="w-3 h-3 mr-1" />
                          <span>{transaction.category}</span>
                        </div>
                        <div className="flex items-center">
                          <CreditCard className="w-3 h-3 mr-1" />
                          <span>{transaction.paymentMethod}</span>
                        </div>
                        <div className="flex items-center">
                          <Calendar className="w-3 h-3 mr-1" />
                          <span>{transaction.date}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div className="flex items-center space-x-2">
                    <div className="text-right">
                      <p className={`font-semibold ${transaction.type === 'income' ? 'text-green-600' : 'text-red-600'}`}>
                        {transaction.type === 'income' ? '+' : '-'}${transaction.amount.toFixed(2)}
                      </p>
                    </div>
                    <button
                      onClick={() => deleteTransaction(transaction.id)}
                      className="text-red-400 hover:text-red-600 p-1 rounded active:scale-95 transition-all"
                    >
                      <Trash2 className="w-4 h-4" />
                    </button>
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}
        
        <div className="mt-8 text-center pb-4">
          <p className="text-xs text-gray-400">My Financial Planning v1.0</p>
          <p className="text-xs text-gray-300">Complete Transaction History</p>
        </div>
      </div>
    </div>
  );

  // Analytics Tab Component
  const AnalyticsTab = () => {
    const incomeTransactions = transactions.filter(t => t.type === 'income');
    const expenseTransactions = transactions.filter(t => t.type === 'expense');
    const paymentTransactions = transactions.filter(t => t.isPayment);
    
    return (
      <div className="p-4 pb-24">
        <div className="flex items-center justify-between mb-6">
          <div>
            <h1 className="text-xl font-bold text-gray-800">Financial Analytics</h1>
            <p className="text-gray-500 text-sm">My Financial Planning</p>
          </div>
          <div className="bg-green-100 p-3 rounded-full">
            <PieChart className="w-5 h-5 text-green-600" />
          </div>
        </div>

        <div className="grid grid-cols-1 gap-4">
          {/* Overview Cards */}
          <div className="bg-white rounded-2xl p-6 shadow-sm">
            <h2 className="text-lg font-semibold text-gray-800 mb-4">Financial Summary</h2>
            <div className="space-y-4">
              <div className="flex justify-between items-center">
                <span className="text-gray-600">Total Income</span>
                <span className="text-green-600 font-semibold text-lg">${totalIncome.toFixed(2)}</span>
              </div>
              <div className="flex justify-between items-center">
                <span className="text-gray-600">Total Expenses</span>
                <span className="text-red-600 font-semibold text-lg">${totalExpenses.toFixed(2)}</span>
              </div>
              <div className="border-t pt-4">
                <div className="flex justify-between items-center">
                  <span className="text-gray-800 font-medium">Net Savings</span>
                  <span className={`font-bold text-xl ${balance >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                    ${balance.toFixed(2)}
                  </span>
                </div>
              </div>
            </div>
          </div>

          {/* Category Breakdown */}
          {categoryBreakdown.length > 0 && (
            <div className="bg-white rounded-2xl p-6 shadow-sm">
              <h2 className="text-lg font-semibold text-gray-800 mb-4">Spending by Category</h2>
              <div className="space-y-3">
                {categoryBreakdown.slice(0, 5).map((item, index) => (
                  <div key={item.category} className="flex items-center justify-between">
                    <div className="flex-1">
                      <div className="flex justify-between items-center mb-1">
                        <span className="text-sm font-medium text-gray-700">{item.category}</span>
                        <span className="text-sm text-gray-500">${item.amount.toFixed(2)}</span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-2">
                        <div 
                          className={`h-2 rounded-full ${
                            index === 0 ? 'bg-red-500' : 
                            index === 1 ? 'bg-orange-500' : 
                            index === 2 ? 'bg-yellow-500' : 
                            index === 3 ? 'bg-blue-500' : 'bg-purple-500'
                          }`}
                          style={{width: `${item.percentage}%`}}
                        ></div>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* Payment Method Breakdown */}
          {paymentBreakdown.length > 0 && (
            <div className="bg-white rounded-2xl p-6 shadow-sm">
              <h2 className="text-lg font-semibold text-gray-800 mb-4">Payment Methods</h2>
              <div className="space-y-3">
                {paymentBreakdown.slice(0, 5).map((item, index) => (
                  <div key={item.method} className="flex items-center justify-between">
                    <div className="flex-1">
                      <div className="flex justify-between items-center mb-1">
                        <div className="flex items-center">
                          <CreditCard className="w-4 h-4 text-gray-400 mr-2" />
                          <span className="text-sm font-medium text-gray-700">{item.method}</span>
                        </div>
                        <span className="text-sm text-gray-500">${item.amount.toFixed(2)}</span>
                      </div>
                      <div className="w-full bg-gray-200 rounded-full h-2">
                        <div 
                          className={`h-2 rounded-full ${
                            index === 0 ? 'bg-blue-500' : 
                            index === 1 ? 'bg-green-500' : 
                            index === 2 ? 'bg-purple-500' : 
                            index === 3 ? 'bg-pink-500' : 'bg-indigo-500'
                          }`}
                          style={{width: `${item.percentage}%`}}
                        ></div>
                      </div>
                      <div className="flex justify-between items-center mt-1">
                        <span className="text-xs text-gray-400">{item.count} transactions</span>
                        <span className="text-xs text-gray-400">{item.percentage.toFixed(1)}%</span>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

          {/* Payment Analytics */}
          {paymentTransactions.length > 0 && (
            <div className="bg-white rounded-2xl p-6 shadow-sm">
              <h2 className="text-lg font-semibold text-gray-800 mb-4">Payment Analytics</h2>
              <div className="grid grid-cols-2 gap-4">
                <div className="text-center bg-blue-50 p-4 rounded-xl">
                  <div className="flex items-center justify-center mb-2">
                    <CreditCard className="w-5 h-5 text-blue-600 mr-1" />
                    <span className="text-2xl font-bold text-blue-600">{paymentTransactions.length}</span>
                  </div>
                  <p className="text-sm text-gray-600">Total Payments</p>
                </div>
                <div className="text-center bg-blue-50 p-4 rounded-xl">
                  <p className="text-2xl font-bold text-blue-600">
                    ${paymentTransactions.reduce((sum, t) => sum + t.amount, 0).toFixed(2)}
                  </p>
                  <p className="text-sm text-gray-600">Payment Volume</p>
                </div>
              </div>
              {paymentTransactions.length > 0 && (
                <div className="mt-4 pt-4 border-t border-gray-100">
                  <p className="text-sm text-gray-600">Average Payment</p>
                  <p className="text-lg font-semibold text-blue-600">
                    ${(paymentTransactions.reduce((sum, t) => sum + t.amount, 0) / paymentTransactions.length).toFixed(2)}
                  </p>
                </div>
              )}
            </div>
          )}

          {/* Transaction Counts */}
          <div className="bg-white rounded-2xl p-6 shadow-sm">
            <h2 className="text-lg font-semibold text-gray-800 mb-4">Activity Summary</h2>
            <div className="grid grid-cols-2 gap-4">
              <div className="text-center">
                <p className="text-2xl font-bold text-green-600">{incomeTransactions.length}</p>
                <p className="text-sm text-gray-500">Income Entries</p>
              </div>
              <div className="text-center">
                <p className="text-2xl font-bold text-red-600">{expenseTransactions.length}</p>
                <p className="text-sm text-gray-500">Expense Entries</p>
              </div>
            </div>
          </div>

          {/* Average Transaction */}
          {transactions.length > 0 && (
            <div className="bg-white rounded-2xl p-6 shadow-sm">
              <h2 className="text-lg font-semibold text-gray-800 mb-4">Transaction Averages</h2>
              <div className="grid grid-cols-2 gap-4">
                {incomeTransactions.length > 0 && (
                  <div className="text-center">
                    <p className="text-xl font-bold text-green-600">
                      ${(totalIncome / incomeTransactions.length).toFixed(2)}
                    </p>
                    <p className="text-sm text-gray-500">Avg Income</p>
                  </div>
                )}
                {expenseTransactions.length > 0 && (
                  <div className="text-center">
                    <p className="text-xl font-bold text-red-600">
                      ${(totalExpenses / expenseTransactions.length).toFixed(2)}
                    </p>
                    <p className="text-sm text-gray-500">Avg Expense</p>
                  </div>
                )}
              </div>
            </div>
          )}

          {/* Financial Health Score */}
          <div className="bg-white rounded-2xl p-6 shadow-sm">
            <h2 className="text-lg font-semibold text-gray-800 mb-4">Financial Health Score</h2>
            <div className="text-center">
              {totalIncome > 0 ? (
                <>
                  <div className={`text-4xl font-bold mb-2 ${
                    balance > totalIncome * 0.2 ? 'text-green-600' : 
                    balance > 0 ? 'text-yellow-600' : 'text-red-600'
                  }`}>
                    {balance > totalIncome * 0.2 ? 'A+' : 
                     balance > 0 ? 'B' : 'C'}
                  </div>
                  <p className="text-sm text-gray-600">
                    {balance > totalIncome * 0.2 ? 'Excellent! You\'re saving well.' : 
                     balance > 0 ? 'Good! Consider saving more.' : 
                     'Review your spending habits.'}
                  </p>
                </>
              ) : (
                <p className="text-gray-500">Add income to see your score</p>
              )}
            </div>
          </div>
        </div>
        
        <div className="mt-8 text-center">
          <p className="text-xs text-gray-400">My Financial Planning v1.0</p>
          <p className="text-xs text-gray-300">Advanced Analytics & Insights</p>
        </div>
      </div>
    );
  };

  return (
    <div className="w-full max-w-sm mx-auto bg-gray-50 min-h-screen relative">
      {/* Mobile Status Bar */}
      <div className="bg-gray-900 text-white text-xs p-2 flex justify-between items-center">
        <span>9:41</span>
        <span>My Financial Planning</span>
        <span>100%</span>
      </div>

      {/* Main Content */}
      <div className="relative">
        {activeTab === 'home' && <HomeTab />}
        {activeTab === 'transactions' && <TransactionsTab />}
        {activeTab === 'analytics' && <AnalyticsTab />}
      </div>

      {/* Bottom Navigation */}
      <div className="fixed bottom-0 left-1/2 transform -translate-x-1/2 w-full max-w-sm bg-white border-t border-gray-200 px-4 py-2">
        <div className="flex justify-around">
          {[
            { id: 'home', icon: Home, label: 'Home' },
            { id: 'transactions', icon: List, label: 'History' },
            { id: 'analytics', icon: TrendingUp, label: 'Analytics' }
          ].map(tab => (
            <button
              key={tab.id}
              onClick={() => setActiveTab(tab.id)}
              className={`flex flex-col items-center py-2 px-3 rounded-lg transition-colors ${
                activeTab === tab.id 
                  ? 'text-purple-600 bg-purple-50' 
                  : 'text-gray-400 hover:text-gray-600'
              }`}
            >
              <tab.icon className="w-5 h-5 mb-1" />
              <span className="text-xs font-medium">{tab.label}</span>
            </button>
          ))}
        </div>
      </div>

      {/* Add Transaction Modal */}
      {showAddForm && (
        <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end">
          <div className="bg-white w-full rounded-t-3xl p-6 transform transition-transform">
            <div className="flex justify-between items-center mb-6">
              <div>
                <h2 className="text-xl font-semibold">
                  {isPaymentMode ? 'Record Payment' : `Add ${type === 'income' ? 'Income' : 'Expense'}`}
                </h2>
                <p className="text-sm text-gray-500">
                  {isPaymentMode ? 'Track your bill payments & transactions' : 'My Financial Planning'}
                </p>
              </div>
              <button 
                onClick={() => {
                  setShowAddForm(false);
                  setIsPaymentMode(false);
                }}
                className="text-gray-400 hover:text-gray-600 p-2"
              >
                ✕
              </button>
            </div>

            <div className="space-y-4">
              {/* Type Toggle - Hidden in Payment Mode */}
              {!isPaymentMode && (
                <div className="flex bg-gray-100 rounded-xl p-1">
                  <button
                    onClick={() => setType('expense')}
                    className={`flex-1 py-2 px-4 rounded-lg font-medium transition-colors ${
                      type === 'expense' ? 'bg-white text-gray-800 shadow-sm' : 'text-gray-500'
                    }`}
                  >
                    Expense
                  </button>
                  <button
                    onClick={() => setType('income')}
                    className={`flex-1 py-2 px-4 rounded-lg font-medium transition-colors ${
                      type === 'income' ? 'bg-white text-gray-800 shadow-sm' : 'text-gray-500'
                    }`}
                  >
                    Income
                  </button>
                </div>
              )}

              {/* Payment Mode Indicator */}
              {isPaymentMode && (
                <div className="bg-blue-50 border border-blue-200 rounded-xl p-3">
                  <div className="flex items-center">
                    <CreditCard className="w-5 h-5 text-blue-600 mr-2" />
                    <span className="text-blue-800 font-medium">Payment Recording Mode</span>
                  </div>
                  <p className="text-blue-600 text-sm mt-1">Recording a bill payment or transaction</p>
                </div>
              )}

              {/* Amount Input */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">Amount</label>
                <div className="relative">
                  <span className="absolute left-3 top-3 text-gray-400">$</span>
                  <input
                    type="number"
                    step="0.01"
                    value={amount}
                    onChange={(e) => setAmount(e.target.value)}
                    placeholder="0.00"
                    className="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-lg"
                  />
                </div>
              </div>

              {/* Description Input */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">Description</label>
                <input
                  type="text"
                  value={description}
                  onChange={(e) => setDescription(e.target.value)}
                  placeholder="Enter description"
                  className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                />
              </div>

              {/* Category Select */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  {isPaymentMode ? 'Payment Category' : 'Category'}
                </label>
                <select
                  value={category}
                  onChange={(e) => setCategory(e.target.value)}
                  className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                >
                  <option value="">Select category</option>
                  {(isPaymentMode ? paymentCategories : categories).map(cat => (
                    <option key={cat} value={cat}>{cat}</option>
                  ))}
                </select>
              </div>

              {/* Payment Method Select */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">Payment Method</label>
                <select
                  value={paymentMethod}
                  onChange={(e) => setPaymentMethod(e.target.value)}
                  className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                >
                  <option value="">Select payment method</option>
                  {paymentMethods.map(method => (
                    <option key={method} value={method}>{method}</option>
                  ))}
                </select>
              </div>

              {/* Action Buttons */}
              <div className="flex space-x-3 pt-4">
                <button
                  onClick={() => {
                    setShowAddForm(false);
                    setIsPaymentMode(false);
                  }}
                  className="flex-1 py-3 px-4 border border-gray-300 text-gray-700 rounded-xl font-medium active:scale-95 transition-transform"
                >
                  Cancel
                </button>
                <button
                  onClick={addTransaction}
                  className={`flex-1 py-3 px-4 text-white rounded-xl font-medium active:scale-95 transition-transform ${
                    isPaymentMode ? 'bg-blue-500 hover:bg-blue-600' :
                    type === 'income' ? 'bg-green-500 hover:bg-green-600' : 'bg-red-500 hover:bg-red-600'
                  }`}
                >
                  {isPaymentMode ? 'Record Payment' : `Add ${type === 'income' ? 'Income' : 'Expense'}`}
                </button>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
}
